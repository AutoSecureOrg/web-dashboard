{% extends 'base.html' %}

{% block title %}System Vulnerability Testing{% endblock %}

{% block content %}
<div class="container">
    <header>
        <div class="header-text">
            <h2>System Testing</h2>

         </div>
        <img class="header-image" src="{{ url_for('static', filename='images/exploit4.png') }}" alt="Authenticated Scanning">
    </header>
    <head>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    </head>

    <div class="input-card">
        <h3>Scan Options</h3>
        <form id="scanner-form" action="{{ url_for('network_scanner') }}" method="POST" enctype="multipart/form-data">
            <label for="scan_type">Scan Type:</label>
            <select id="scan_type" name="scan_type" required>
                <option value="single">Single IP</option>
                <option value="range">IP Range</option>
            </select>

            <div id="single-scan">
                <label for="target_ip">Target IP Address:</label>
                <input type="text" id="target_ip" name="target_ip" placeholder="e.g., 192.168.1.1">
            </div>

            <div id="range-scan" style="display: none;">
                <label for="start_ip">Start IP:</label>
                <input type="text" id="start_ip" name="start_ip" placeholder="e.g., 192.168.1.1">
                <label for="end_ip">End IP:</label>
                <input type="text" id="end_ip" name="end_ip" placeholder="e.g., 192.168.1.255">
            </div>

            <label for="start_port">Start Port:</label>
            <input type="number" id="start_port" name="start_port" value="1" required>

            <label for="end_port">End Port:</label>
            <input type="number" id="end_port" name="end_port" value="65535" required>

            <div style="margin-top: 15px; margin-bottom: 10px;">
                <label for="custom_exploit">Upload Custom Exploit (Optional Python Script):</label>
                <input type="file" id="custom_exploit" name="custom_exploit" accept=".py">
                <small class="form-text text-muted">(Script should accept target IP as the first argument)</small>
            </div>

            <div class="checkbox-container">
                <input type="checkbox" id="authorized" name="authorized" required>
                <label for="authorized">
                    I agree to the <a href="#">Terms of Service</a>.
                </label>
            </div>
            <button type="submit">Start Scan</button>
        </form>
    </div>

    <div id="scanning-icon" class="hidden">
        <div class="spinner"></div>
        <p>Scanning in progress... Please wait.</p>
    </div>
</div>

<script>
    const form = document.getElementById('scanner-form');
    const scanningIcon = document.getElementById('scanning-icon');
    const scanType = document.getElementById('scan_type');
    const singleScan = document.getElementById('single-scan');
    const rangeScan = document.getElementById('range-scan');

    // Show/hide scan options
    scanType.addEventListener('change', () => {
        if (scanType.value === 'single') {
            singleScan.style.display = 'block';
            rangeScan.style.display = 'none';
        } else {
            singleScan.style.display = 'none';
            rangeScan.style.display = 'block';
        }
    });

    // Handle form submission
    form.addEventListener('submit', () => {
        // Show scanning icon
        scanningIcon.classList.remove('hidden');
    });
</script>

{% include 'footer.html' %}
{% endblock %}
